<!DOCTYPE html>
<html>
    <head>
        <title>Live Translations</title>
        <link href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet">
        <link rel="stylesheet" type="text/css" href="/web/css/styles.css">
        <link rel="stylesheet" type="text/css" href="/web/css/switch.css">
        <link rel="stylesheet" type="text/css" href="/web/css/slidebar.css">
    </head>
    <body>
        <header>
            <div id="header-left">
                <!-- menu button to toggle controls -->
                <i class="material-icons" id="menu-button">menu</i>
                <i class="material-icons" id="toggle-start">play_arrow</i>
            </div>
            <div id="header-center">
                <h1>Live Translations</h1>
            </div>
            <div id="header-right">
                <!-- material icons light bulb (transparent) -->
                <!-- display active microphone name -->
                <span id="microphone-name"></span>
                <i class="material-icons" id="lightbulb">lightbulb</i>
            </div>
        </header>
        <main>
            <div id="content">
                <div id="translations"></div>
                <div id="transcript">
                    <div class="history" data-language="transcript"></div>
                    <div class="currentText"></div>
                    <div class="language">Transcript</div>
                </div>
            </div>
        </main>
        <script src="https://cdn.socket.io/4.7.1/socket.io.js"></script>
        <script src="/web/js/socket.js"></script>
        
        <script>
            window.addEventListener('beforeunload', (e) => {
                const url = window.location.pathname;
                const instanceId = url.split('/')[1];
                const language = url.split('/')[2];
                socket.emit('tab_closed', { instance: instanceId, language: language });
            });
            // on page load, if url has instance id and language
            // socket.emit('tab-active', { instance: 'instance-id', language: 'English' });
            window.addEventListener('load', (e) => {
                const url = window.location.pathname;
                const instanceId = url.split('/')[1];
                const language = url.split('/')[2];
                if (instanceId && language) {
                    socket.emit('tab_active', { instance: instanceId, language: language});
                }
            });
            // on page refresh
        </script>
        <!-- <script src="/web/js/script.js"></script> -->
        <script src="/web/js/main.js"></script>
    </body>
</html>
